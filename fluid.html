<link rel="icon" href="drive-logo.png">
<title>DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players</title>

<!-- Meta Tags for SEO -->
<meta name="description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta name="keywords" content="DrivePlyr, Google Drive, Proxy, Video Player, HTML5 Player, Hidden ID, Features">
<meta name="author" content="SH20RAJ">

<!-- Open Graph / Facebook -->
<meta property="og:type" content="website">
<meta property="og:url" content="https://rabbi0197273.github.io/Rabbi123/">
<meta property="og:title" content="DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players">
<meta property="og:description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta property="og:image" content="https://sh20raj.github.io/DrivePlyr/drive-logo.png">

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image">
<meta property="twitter:url" content="https://rabbi0197273.github.io/Rabbi123/">
<meta property="twitter:title" content="DrivePlyr - Google Drive Proxy Video Player with Many Powerful HTML5 Players">
<meta property="twitter:description" content="DrivePlyr is a Google Drive Proxy Video Player with Many Powerful HTML5 Players, Hidden ID, and Many Features. Play your videos from Google Drive with ease.">
<meta property="twitter:image" content="https://sh20raj.github.io/DrivePlyr/drive-logo.png">

<!-- Other Meta Tags -->
<link rel="icon" href="https://raw.githubusercontent.com/SH20RAJ/DrivePlyr/main/drive-logo.png">
<meta name="theme-color" content="#000000">
<meta name="robots" content="index, follow">

<style>
  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    background: black;
  }

  video {
    width: 100%;
    height: 100%;
    object-fit: contain !important;
    display: block;
    background-color: black;
  }

  
  video:-webkit-full-screen {
    object-fit: contain !important;
    background-color: black;
  }

  video:-moz-full-screen {
    object-fit: contain !important;
    background-color: black;
  }

  video:fullscreen {
    object-fit: contain !important;
    background-color: black;
  }
</style>

<script src="https://cdn.fluidplayer.com/v3/current/fluidplayer.min.js"></script>

<video poster="https://bit.ly/bbsampleposter" id="video-id" playsinline controls crossorigin="anonymous">
  <source src="https://bit.ly/bbsamplevideo" type="video/mp4" />
</video>

<script>
  var myFP = fluidPlayer('video-id', {
    "layoutControls": {
      "controlBar": {
        "autoHideTimeout": 3,
        "animated": true,
        "autoHide": true
      },
      "htmlOnPauseBlock": {
        "html": null,
        "height": null,
        "width": null
      },
      "autoPlay": false,
      "mute": false,
      "allowTheatre": true,
      "playPauseAnimation": true,
      "playbackRateEnabled": true,
      "allowDownload": false,
      "playButtonShowing": true,
      "fillToContainer": true,
      "posterImage": ""
    },
    "vastOptions": {
      "adList": [],
      "adCTAText": false,
      "adCTATextPosition": ""
    }
  });

  // Google Drive PIP fix - video load হওয়ার পর PIP enable করা
  function enablePIPForGoogleDrive() {
    const video = document.getElementById('video-id');
    
    // Video metadata load হওয়ার জন্য অপেক্ষা
    video.addEventListener('loadedmetadata', function() {
      // Google Drive video এর জন্য PIP manually enable করা
      if (video.src.includes('googleapis.com') || video.src.includes('googleusercontent.com')) {
        // Force enable PIP for Google Drive videos
        video.disablePictureInPicture = false;
        
        // Video element এ PIP attributes যোগ করা
        video.setAttribute('disablePictureInPicture', 'false');
        video.setAttribute('controlsList', 'nodownload');
      }
    });

    // Video ready হওয়ার পর PIP button functionality যোগ করা
    video.addEventListener('canplay', function() {
      setTimeout(function() {
        // FluidPlayer এর সব button খুঁজে PIP functionality যোগ করা
        const allButtons = document.querySelectorAll('button, .fluid_button, [class*="button"], [class*="control"]');
        
        allButtons.forEach(function(btn) {
          // PIP button identify করা (icon বা class দিয়ে)
          const btnHTML = btn.innerHTML.toLowerCase();
          const btnClass = btn.className.toLowerCase();
          const btnTitle = (btn.title || '').toLowerCase();
          
          if (btnHTML.includes('picture') || btnHTML.includes('pip') || 
              btnClass.includes('pip') || btnClass.includes('picture') ||
              btnTitle.includes('picture') || btnTitle.includes('pip') ||
              btn.getAttribute('aria-label')?.toLowerCase().includes('picture')) {
            
            // পুরানো event listeners সরানো
            btn.onclick = null;
            btn.removeAttribute('onclick');
            
            // নতুন PIP functionality যোগ করা
            btn.addEventListener('click', function(e) {
              e.preventDefault();
              e.stopPropagation();
              
              // PIP support check করা
              if ('pictureInPictureEnabled' in document && document.pictureInPictureEnabled && !video.disablePictureInPicture) {
                if (document.pictureInPictureElement) {
                  document.exitPictureInPicture()
                    .then(() => console.log('PIP exited'))
                    .catch(err => console.log('PIP exit error:', err));
                } else {
                  video.requestPictureInPicture()
                    .then(() => console.log('PIP activated'))
                    .catch(err => {
                      console.log('PIP error:', err);
                      // Fallback: video clone করে PIP চালানো
                      tryPIPFallback();
                    });
                }
              } else {
                console.log('PIP not supported or disabled');
                tryPIPFallback();
              }
            });
          }
        });
      }, 3000); // FluidPlayer fully load হওয়ার জন্য অপেক্ষা
    });
  }

  // PIP Fallback method - যদি normal PIP কাজ না করে
  function tryPIPFallback() {
    const video = document.getElementById('video-id');
    
    // Video এর current time এবং play state save করা
    const currentTime = video.currentTime;
    const isPaused = video.paused;
    
    // নতুন video element create করা PIP এর জন্য
    const pipVideo = document.createElement('video');
    pipVideo.src = video.src;
    pipVideo.currentTime = currentTime;
    pipVideo.controls = true;
    pipVideo.style.position = 'fixed';
    pipVideo.style.top = '20px';
    pipVideo.style.right = '20px';
    pipVideo.style.width = '300px';
    pipVideo.style.height = '200px';
    pipVideo.style.zIndex = '9999';
    pipVideo.style.border = '2px solid #fff';
    pipVideo.style.borderRadius = '8px';
    
    if (!isPaused) {
      pipVideo.play();
    }
    
    document.body.appendChild(pipVideo);
    
    // Original video pause করা
    video.pause();
    
    // PIP video close করার জন্য double click
    pipVideo.addEventListener('dblclick', function() {
      video.currentTime = pipVideo.currentTime;
      if (!pipVideo.paused) {
        video.play();
      }
      document.body.removeChild(pipVideo);
    });
  }

  // PIP functionality initialize করা
  enablePIPForGoogleDrive();
</script>

<script>
  var apikey = [
    'AIzaSyCt3DULzE2trDJhfFUosWZT-3GEObbMqVU',
    'AIzaSyCsbx8BSyLwkw6XX6Lg5OF1U0HNtI9VmCY',
    'AIzaSyBLMJAT6oqTZxAMsCsMjXzoo4lkJL4MmfM',
    'AIzaSyCIY6fomcJxOt0XQ_naa1rzfd5wlOMGKDY'
  ][Math.floor(Math.random() * 4)];
  console.log(apikey);

  function getparam(a, e) {
    return e || (e = window.location.href), new URL(e).searchParams.get(a)
  }

  let video = document.getElementById('video-id');
  if (getparam('id')) {
    let json = JSON.parse(atob(getparam('id')));
    let driveid = json.id;
    video.src = `https://www.googleapis.com/drive/v3/files/${driveid}?alt=media&key=${apikey}`;
    video.poster = 'https://lh3.googleusercontent.com/d/' + driveid;
    
    // Google Drive video load হওয়ার পর PIP enable করা
    video.addEventListener('loadeddata', function() {
      video.disablePictureInPicture = false;
    });
  }

  function forceRotation() {
    if (screen.orientation && screen.orientation.lock) {
      screen.orientation.lock("landscape-primary").catch(function (error) {
        console.log("Orientation lock failed:", error);
      });
    }
  }

  function onFullscreenChange() {
    if (
      document.fullscreenElement ||
      document.webkitFullscreenElement ||
      document.mozFullScreenElement ||
      document.msFullscreenElement
    ) {
      forceRotation();
    }
  }

  document.addEventListener("fullscreenchange", onFullscreenChange);
  document.addEventListener("webkitfullscreenchange", onFullscreenChange);
  document.addEventListener("mozfullscreenchange", onFullscreenChange);
  document.addEventListener("MSFullscreenChange", onFullscreenChange);
</script>
